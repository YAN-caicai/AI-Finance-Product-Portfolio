<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>è´¢åŠ¡æŠ¥é”€åˆè§„åŠ©æ‰‹ Â· åŸå‹</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg-page: #f5f6f8;
      --bg-card: #ffffff;
      --border-subtle: #e2e4e8;
      --text-main: #1d1f23;
      --text-muted: #757b87;
      --accent: #1f6feb;
      --accent-soft: #e6f0ff;
      --radius-lg: 16px;
      --radius-md: 10px;
      --shadow-soft: 0 18px 45px rgba(15, 23, 42, 0.08);

      --success-bg: #e7f7ef;
      --success-text: #16784e;
      --warning-bg: #fff3e4;
      --warning-text: #b45309;
      --error-bg: #ffe7e7;
      --error-text: #b91c1c;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
      background: radial-gradient(circle at top left, #f9fafb 0, #eff1f5 40%, #e5e7eb 100%);
      color: var(--text-main);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px 16px;
    }

    .shell {
      width: 100%;
      max-width: 960px;
      background: linear-gradient(135deg, #ffffff, #f8fafc);
      border-radius: 28px;
      box-shadow: var(--shadow-soft);
      border: 1px solid rgba(148, 163, 184, 0.2);
      padding: 24px 26px 26px;
    }

    .shell-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 18px;
    }

    .shell-title {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .shell-title-main {
      font-size: 18px;
      font-weight: 600;
      letter-spacing: 0.02em;
    }

    .shell-title-sub {
      font-size: 12px;
      color: var(--text-muted);
    }

    .chip {
      font-size: 11px;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: rgba(248, 250, 252, 0.7);
      color: var(--text-muted);
    }

    .chip-dot {
      width: 7px;
      height: 7px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 20%, #22c55e, #16a34a);
      box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.18);
    }

    .input-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 18px;
      align-items: stretch;
    }

    .input-shell {
      position: relative;
      flex: 1 1 260px;
      display: flex;
      align-items: center;
      background: #f9fafb;
      border-radius: 999px;
      border: 1px solid var(--border-subtle);
      padding: 8px 14px 8px 38px;
      transition: border-color 0.18s ease, box-shadow 0.18s ease,
        background 0.18s ease;
    }

    .input-shell.focused {
      background: #ffffff;
      border-color: rgba(31, 111, 235, 0.7);
      box-shadow: 0 0 0 1px rgba(31, 111, 235, 0.2);
    }

    .input-icon {
      position: absolute;
      left: 14px;
      font-size: 14px;
      color: var(--text-muted);
      pointer-events: none;
    }

    .input-shell input {
      border: none;
      outline: none;
      background: transparent;
      width: 100%;
      font-size: 13px;
      color: var(--text-main);
    }

    .input-shell input::placeholder {
      color: #a0a5b3;
    }

    .btn-primary {
      flex: 0 0 auto;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 0 18px;
      border-radius: 999px;
      font-size: 13px;
      font-weight: 500;
      border: none;
      cursor: pointer;
      background: radial-gradient(circle at 10% 0, #60a5fa, #1d4ed8);
      color: #ffffff;
      box-shadow: 0 10px 25px rgba(37, 99, 235, 0.45);
      transition: transform 0.12s ease, box-shadow 0.12s ease,
        filter 0.12s ease;
      min-height: 38px;
      white-space: nowrap;
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 30px rgba(37, 99, 235, 0.55);
      filter: brightness(1.03);
    }

    .btn-primary:active {
      transform: translateY(0);
      box-shadow: 0 8px 18px rgba(37, 99, 235, 0.38);
      filter: brightness(0.98);
    }

    .btn-primary:disabled {
      opacity: 0.6;
      cursor: default;
      box-shadow: none;
      transform: none;
    }

    .btn-primary span.icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: rgba(15, 23, 42, 0.16);
      font-size: 11px;
    }

    .meta-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
      font-size: 11px;
      color: var(--text-muted);
    }

    .meta-label {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .meta-label-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: #9ca3af;
    }

    .confidence-tag {
      padding: 3px 10px;
      border-radius: 999px;
      background: rgba(22, 163, 74, 0.08);
      color: #15803d;
      border: 1px solid rgba(34, 197, 94, 0.28);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .confidence-tag span.dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 20%, #4ade80, #16a34a);
    }

    .audit-card {
      border-radius: var(--radius-lg);
      background: var(--bg-card);
      border: 1px solid rgba(148, 163, 184, 0.3);
      padding: 14px 16px 16px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .audit-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
    }

    .audit-title {
      font-size: 13px;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .audit-title-pill {
      font-size: 10px;
      padding: 2px 7px;
      border-radius: 999px;
      background: #f3f4f6;
      color: var(--text-muted);
    }

    .audit-input-echo {
      font-size: 11px;
      color: var(--text-muted);
      border-radius: 8px;
      background: #f9fafb;
      padding: 6px 9px;
      border: 1px dashed rgba(148, 163, 184, 0.6);
      display: none;
    }

    .audit-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 10px;
      margin-top: 2px;
    }

    @media (max-width: 768px) {
      body {
        padding: 20px 12px;
        align-items: flex-start;
      }
      .shell {
        padding: 18px 16px 18px;
        border-radius: 22px;
      }
      .audit-grid {
        grid-template-columns: 1fr;
      }
      .input-row {
        flex-direction: column;
        align-items: stretch;
      }
      .btn-primary {
        width: 100%;
        justify-content: center;
      }
    }

    .pill {
      border-radius: var(--radius-md);
      padding: 8px 10px;
      font-size: 11px;
      line-height: 1.5;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .pill-label {
      font-weight: 500;
    }

    .pill-sub {
      font-size: 10px;
      opacity: 0.85;
    }

    .pill-success {
      background: var(--success-bg);
      color: var(--success-text);
    }

    .pill-warning {
      background: var(--warning-bg);
      color: var(--warning-text);
    }

    .pill-error {
      background: var(--error-bg);
      color: var(--error-text);
    }

    .pill-muted {
      background: #f3f4f6;
      color: #6b7280;
    }

    .empty-hint {
      font-size: 11px;
      color: var(--text-muted);
      padding: 10px 0 2px;
    }

    .empty-hint span {
      font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco,
        Consolas, "Liberation Mono", "Courier New", monospace;
      background: rgba(15, 23, 42, 0.04);
      padding: 2px 4px;
      border-radius: 4px;
      font-size: 10px;
    }
  </style>
</head>
<body>
  <main class="shell">
    <header class="shell-header">
      <div class="shell-title">
        <div class="shell-title-main">è´¢åŠ¡æŠ¥é”€åˆè§„åŠ©æ‰‹ Â· åŸå‹</div>
        <div class="shell-title-sub">Demo åŒºåŸŸ Â· æœ¬åœ°æ¨¡æ‹Ÿå®¡è®¡é€»è¾‘ï¼ˆæ— è”ç½‘ï¼Œæ— çœŸå®æŠ¥é”€æ•°æ®ï¼‰</div>
      </div>
      <div class="chip">
        <span class="chip-dot"></span>
        å†…æµ‹ Â· Finance Ops
      </div>
    </header>

    <section class="input-row">
      <div class="input-shell" id="input-shell">
        <span class="input-icon">ğŸ”</span>
        <input
          id="expense-input"
          type="text"
          placeholder="è¾“å…¥æŠ¥é”€å†…å®¹ï¼Œä¾‹å¦‚ï¼šä¸Šæµ·å‡ºå·®æ™šé¤è´¹650å…ƒ..."
          autocomplete="off"
        />
      </div>
      <button id="audit-button" class="btn-primary">
        <span class="icon">AI</span>
        <span>AI åˆè§„å®¡è®¡</span>
      </button>
    </section>

    <section class="meta-row">
      <div class="meta-label">
        <span class="meta-label-dot"></span>
        <span>å®¡è®¡é€»è¾‘æ‹†è§£ Â· æ¨¡æ‹Ÿç‰ˆ</span>
      </div>
      <div class="confidence-tag">
        <span class="dot"></span>
        <span>AI ç½®ä¿¡åº¦ï¼š98%</span>
      </div>
    </section>

    <section class="audit-card">
      <header class="audit-header">
        <div class="audit-title">
          å®¡è®¡é€»è¾‘æ‹†è§£
          <span class="audit-title-pill">A/B/C ä¸‰æ®µå¼</span>
        </div>
      </header>

      <div id="audit-input-echo" class="audit-input-echo"></div>

      <div id="audit-grid" class="audit-grid">
        <div class="pill pill-muted">
          <div class="pill-label">é€»è¾‘ A Â· åˆè§„æ€§æ£€æŸ¥</div>
          <div class="pill-sub">ç­‰å¾…è¾“å…¥ç¤ºä¾‹ï¼Œå¦‚â€œä¸Šæµ·å‡ºå·®æ™šé¤è´¹650å…ƒâ€</div>
        </div>
        <div class="pill pill-muted">
          <div class="pill-label">é€»è¾‘ B Â· å…³é”®è¦ç´ æ£€æŸ¥</div>
          <div class="pill-sub">åœ°ç‚¹ã€é‡‘é¢ã€äº‹ç”±ç­‰ç»´åº¦å°†è¢«æ‹†è§£é¢„è§ˆ</div>
        </div>
        <div class="pill pill-muted">
          <div class="pill-label">é€»è¾‘ C Â· ç­–ç•¥å»ºè®®</div>
          <div class="pill-sub">ç»“åˆ A/B ç»“æœç»™å‡º AI å»ºè®®è¯æœ¯</div>
        </div>
      </div>

      <div class="empty-hint">
        è¾“å…¥ä»»æ„ä¸€æ¡æ‹ŸæŠ¥é”€è¯´æ˜å¹¶ç‚¹å‡» <span>AI åˆè§„å®¡è®¡</span>ï¼Œå³å¯çœ‹åˆ° A/B/C é€»è¾‘æ‹†è§£æ•ˆæœã€‚
      </div>
    </section>
  </main>

  <script>
    (function () {
      const input = document.getElementById("expense-input");
      const button = document.getElementById("audit-button");
      const grid = document.getElementById("audit-grid");
      const inputEcho = document.getElementById("audit-input-echo");
      const inputShell = document.getElementById("input-shell");

      input.addEventListener("focus", () => {
        inputShell.classList.add("focused");
      });

      input.addEventListener("blur", () => {
        inputShell.classList.remove("focused");
      });

      function parseAmount(text) {
        if (!text) return null;
        const numMatches = text.match(/(\d+(?:\.\d+)?)/g);
        if (!numMatches || numMatches.length === 0) return null;
        const value = parseFloat(numMatches[numMatches.length - 1]);
        return isNaN(value) ? null : value;
      }

      function includesAny(text, keywords) {
        if (!text) return false;
        return keywords.some((k) => text.includes(k));
      }

      function analyze(text) {
        const normalized = (text || "").trim();
        const amount = parseAmount(normalized);
        const hasMeal = includesAny(normalized, ["é¤é¥®", "æ™šé¤", "åˆé¤", "æ—©é¤", "èšé¤", "å·¥ä½œé¤", "é¤è´¹"]);
        const hasLocation = includesAny(normalized, ["åŒ—äº¬", "ä¸Šæµ·", "å¹¿å·", "æ·±åœ³", "æ­å·", "å—äº¬", "æˆéƒ½", "æ­¦æ±‰", "è¥¿å®‰"]);

        const result = {
          logicA: {
            triggered: false,
            type: "success",
            label: "é€»è¾‘ A Â· åˆè§„æ€§æ£€æŸ¥",
            detail: "",
          },
          logicB: {
            triggered: false,
            type: "success",
            label: "é€»è¾‘ B Â· å…³é”®è¦ç´ æ£€æŸ¥",
            detail: "",
          },
          logicC: {
            type: "success",
            label: "é€»è¾‘ C Â· ç­–ç•¥å»ºè®®",
            detail: "",
          },
          meta: {
            amount,
            hasMeal,
            hasLocation,
          },
        };

        // é€»è¾‘ Aï¼šé‡‘é¢ > 500 ä¸”åŒ…å«â€œé¤é¥®â€
        if (amount != null && amount > 500 && hasMeal) {
          result.logicA.triggered = true;
          result.logicA.type = "warning";
          result.logicA.detail = "âš ï¸ æ£€æµ‹åˆ°é¤é¥®ç±»æŠ¥é”€é‡‘é¢è¶…è¿‡ 500 å…ƒï¼Œè§¦å‘è¶…æ ‡é¢„è­¦ï¼Œå¯æ ¹æ®å†…éƒ¨å·®æ—…/é¤é¥®æ ‡å‡†è¿›ä¸€æ­¥æ ¸å¯¹ã€‚";
        } else if (!normalized) {
          result.logicA.type = "muted";
          result.logicA.detail = "ç­‰å¾…è¾“å…¥ç¤ºä¾‹ï¼Œå¦‚â€œä¸Šæµ·å‡ºå·®æ™šé¤è´¹650å…ƒâ€ã€‚";
        } else {
          result.logicA.type = "success";
          if (hasMeal && amount != null) {
            result.logicA.detail = "âœ… é¤é¥®æŠ¥é”€é‡‘é¢æœªè¶…è¿‡ 500 å…ƒï¼Œåˆæ­¥è§†ä¸ºåœ¨æ ‡å‡†èŒƒå›´å†…ã€‚";
          } else if (!hasMeal && amount != null) {
            result.logicA.detail = "âœ… å½“å‰è¯´æ˜æœªè¯†åˆ«ä¸ºé¤é¥®ç±»è´¹ç”¨ï¼Œä¸è§¦å‘è¯¥è§„åˆ™è¶…æ ‡æ£€æŸ¥ã€‚";
          } else {
            result.logicA.detail = "â„¹ï¸ æœªèƒ½ç¨³å®šè§£æé‡‘é¢æˆ–è´¹ç”¨ç±»å‹ï¼Œè¯¥è§„åˆ™æš‚ä¸è§¦å‘é¢„è­¦ã€‚";
          }
        }

        // é€»è¾‘ Bï¼šæ˜¯å¦åŒ…å«åœ°ç‚¹ä¿¡æ¯
        if (!normalized) {
          result.logicB.type = "muted";
          result.logicB.detail = "åœ°ç‚¹ã€é‡‘é¢ã€äº‹ç”±ç­‰ç»´åº¦å°†åœ¨è¾“å…¥åè‡ªåŠ¨æ‹†è§£é¢„è§ˆã€‚";
        } else if (!result.meta.hasLocation) {
          result.logicB.triggered = true;
          result.logicB.type = "error";
          result.logicB.detail = "âŒ æœªè¯†åˆ«åˆ°åŸå¸‚ä¿¡æ¯ï¼ˆå¦‚åŒ—äº¬ã€ä¸Šæµ·ç­‰ï¼‰ï¼Œå»ºè®®è¡¥å……å‡ºå·®åŸå¸‚æˆ–å‘ç”Ÿåœ°ç‚¹ï¼Œä¾¿äºå·®æ—…ä¸é¢„ç®—æ ¸å¯¹ã€‚";
        } else {
          result.logicB.type = "success";
          result.logicB.detail = "âœ… å·²è¯†åˆ«åˆ°åŸå¸‚ä¿¡æ¯ï¼Œå¯æ”¯æŒåç»­è¡Œç¨‹æ ¸å¯¹ä¸é¢„ç®—å½’é›†ã€‚";
        }

        // é€»è¾‘ Cï¼šç­–ç•¥å»ºè®®ï¼Œæ ¹æ® A/B ç»„åˆ
        const issues = [];
        if (result.logicA.type === "warning") issues.push("amountMeal");
        if (result.logicB.type === "error") issues.push("locationMissing");

        if (!normalized) {
          result.logicC.type = "muted";
          result.logicC.detail =
            "ç¤ºä¾‹ï¼šå¯å¼•å¯¼å‘˜å·¥æŒ‰ç…§â€œåŸå¸‚ + äº‹ç”± + é‡‘é¢â€ç»Ÿä¸€æ ¼å¼å¡«å†™ï¼Œä¾‹å¦‚â€œä¸Šæµ·å‡ºå·®Â·å®¢æˆ·æ™šé¤ 650 å…ƒâ€ã€‚";
        } else if (issues.length === 0) {
          result.logicC.type = "success";
          result.logicC.detail =
            "ä»å½“å‰è¯´æ˜çœ‹ï¼Œå…³é”®è¦ç´ ç›¸å¯¹å®Œæ•´ï¼Œä¸”æœªè§¦å‘æ˜æ˜¾è¶…æ ‡é£é™©ã€‚å»ºè®®åç»­ç»“åˆå‘ç¥¨æŠ¬å¤´ã€è¡Œç¨‹å•å’Œé¢„ç®—ç»´åº¦å†åšä¸€æ¬¡é›†ä¸­æŠ½æ ·å®¡è®¡ã€‚";
        } else if (issues.includes("amountMeal") && issues.includes("locationMissing")) {
          result.logicC.type = "error";
          result.logicC.detail =
            "å»ºè®®ï¼šâ‘  è¡¥å……å‡ºå·®åŸå¸‚æˆ–è´¹ç”¨å‘ç”Ÿåœ°ç‚¹ï¼›â‘¡ è¯·å‘˜å·¥ç¡®è®¤è¯¥é¤é¥®è´¹ç”¨æ˜¯å¦æŒ‰å…¬å¸é¤é¥®æ ‡å‡†æ‹†åˆ†æˆ–åˆå¹¶æŠ¥é”€ï¼›â‘¢ å¦‚ä¸ºå®¢æˆ·æ¥å¾…ï¼Œè¯·è¡¥å……æ¥å¾…å¯¹è±¡åŠåœºæ™¯è¯´æ˜ï¼Œä¾¿äºåç»­æŠ½æŸ¥ã€‚";
        } else if (issues.includes("amountMeal")) {
          result.logicC.type = "warning";
          result.logicC.detail =
            "å»ºè®®é‡ç‚¹å…³æ³¨è¯¥é¤é¥®è´¹ç”¨æ˜¯å¦åœ¨å…¬å¸å·®æ—…/é¤é¥®æ ‡å‡†èŒƒå›´å†…ï¼Œå¯åœ¨ç³»ç»Ÿä¸­å¢åŠ è‡ªåŠ¨å°é¡¶è§„åˆ™ï¼Œè¶…æ ‡éƒ¨åˆ†æç¤ºå‘˜å·¥è‡ªè¡Œæ‰¿æ‹…æˆ–èµ°å®¡æ‰¹åŠ ç­¾ã€‚";
        } else if (issues.includes("locationMissing")) {
          result.logicC.type = "warning";
          result.logicC.detail =
            "å»ºè®®åœ¨æŠ¥é”€å•æ¨¡æ¿ä¸­å°†â€œå‘ç”ŸåŸå¸‚/å‡ºå·®åŸå¸‚â€è®¾ä¸ºå¿…å¡«å­—æ®µï¼Œå‡å°‘åç»­è´¢åŠ¡è¡¥èµ„æ–™çš„æ²Ÿé€šæˆæœ¬ï¼Œå¹¶æ”¯æŒé¢„ç®—æŒ‰åŸå¸‚ç»´åº¦åšåˆ†æã€‚";
        }

        return result;
      }

      function createPill(type, label, detail) {
        const div = document.createElement("div");
        let cls = "pill ";
        switch (type) {
          case "success":
            cls += "pill-success";
            break;
          case "warning":
            cls += "pill-warning";
            break;
          case "error":
            cls += "pill-error";
            break;
          case "muted":
          default:
            cls += "pill-muted";
            break;
        }
        div.className = cls;

        const title = document.createElement("div");
        title.className = "pill-label";
        title.textContent = label;

        const sub = document.createElement("div");
        sub.className = "pill-sub";
        sub.textContent = detail;

        div.appendChild(title);
        div.appendChild(sub);
        return div;
      }

      function render(normalizedText, analysis) {
        while (grid.firstChild) {
          grid.removeChild(grid.firstChild);
        }

        if (!normalizedText) {
          inputEcho.style.display = "none";
        } else {
          inputEcho.style.display = "block";
          inputEcho.textContent = "å½“å‰å¾…å®¡è®¡è¯´æ˜ï¼š" + normalizedText;
        }

        const a = analysis.logicA;
        const b = analysis.logicB;
        const c = analysis.logicC;

        grid.appendChild(createPill(a.type, a.label, a.detail));
        grid.appendChild(createPill(b.type, b.label, b.detail));
        grid.appendChild(createPill(c.type, c.label, c.detail));
      }

      function handleAudit() {
        const raw = input.value || "";
        const normalized = raw.trim();

        button.disabled = true;

        setTimeout(() => {
          const result = analyze(normalized);
          render(normalized, result);
          button.disabled = false;
        }, 260); // æ¨¡æ‹Ÿ AI æ€è€ƒå»¶è¿Ÿ
      }

      button.addEventListener("click", handleAudit);
      input.addEventListener("keydown", (evt) => {
        if (evt.key === "Enter") {
          evt.preventDefault();
          handleAudit();
        }
      });
    })();
  </script>
</body>
</html>

